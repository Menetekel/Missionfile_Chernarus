disableSerialization;if(R3F_LOG_mutex_local_verrou)then{player globalChat STR_R3F_LOG_mutex_action_en_cours;}else{R3F_LOG_mutex_local_verrou=true;private["_l0","_l1","_l2","_l3","_l4"];private["_l5","_l6","_l7","_l8","_l9"];_l0=_this select 0;uiNamespace setVariable["R3F_LOG_dlg_CV_transporteur",_l0];createDialog"R3F_LOG_dlg_contenu_vehicule";_l3=_l0 getVariable"R3F_LOG_objets_charges";_l5=[];_l6=[];_l1=0;for[{_l7=0},{_l7<count _l3},{_l7=_l7+1}]do{private["_l10"];_l10=_l3 select _l7;if!((typeOf _l10)in _l5)then{_l5=_l5+[typeOf _l10];_l6=_l6+[1];}else{private["_l11"];_l11=_l5 find(typeOf _l10);_l6 set[_l11,((_l6 select _l11)+1)];};for[{_l8=0},{_l8<count R3F_LOG_CFG_objets_transportables},{_l8=_l8+1}]do{if(_l10 isKindOf(R3F_LOG_CFG_objets_transportables select _l8 select 0))exitWith{_l1=_l1+(R3F_LOG_CFG_objets_transportables select _l8 select 1);};};};_l2=0;for[{_l7=0},{_l7<count R3F_LOG_CFG_transporteurs},{_l7=_l7+1}]do{if(_l0 isKindOf(R3F_LOG_CFG_transporteurs select _l7 select 0))exitWith{_l2=(R3F_LOG_CFG_transporteurs select _l7 select 1);};};
#include "dlg_constantes.h"
private["_l12"];_l9=findDisplay R3F_LOG_IDD_dlg_contenu_vehicule;(_l9 displayCtrl R3F_LOG_IDC_dlg_CV_titre)ctrlSetText STR_R3F_LOG_dlg_CV_titre;(_l9 displayCtrl R3F_LOG_IDC_dlg_CV_credits)ctrlSetText STR_R3F_ARTY_LOG_nom_produit;(_l9 displayCtrl R3F_LOG_IDC_dlg_CV_btn_decharger)ctrlSetText STR_R3F_LOG_dlg_CV_btn_decharger;(_l9 displayCtrl R3F_LOG_IDC_dlg_CV_btn_fermer)ctrlSetText STR_R3F_LOG_dlg_CV_btn_fermer;(_l9 displayCtrl R3F_LOG_IDC_dlg_CV_capacite_vehicule)ctrlSetText(format[STR_R3F_LOG_dlg_CV_capacite_vehicule,_l1,_l2]);_l12=_l9 displayCtrl R3F_LOG_IDC_dlg_CV_liste_contenu;if(count _l5==0)then{(_l9 displayCtrl R3F_LOG_IDC_dlg_CV_btn_decharger)ctrlEnable false;}else{for[{_l7=0},{_l7<count _l5},{_l7=_l7+1}]do{private["_l13","_l14"];_l14=getText(configFile>>"CfgVehicles">>(_l5 select _l7)>>"icon");if(toString([toArray _l14 select 0])=="\")then{_l13=_l12 lbAdd(getText(configFile>>"CfgVehicles">>(_l5 select _l7)>>"displayName")+format["(%1x)",_l6 select _l7]);_l12 lbSetPicture[_l13,_l14];}else{if(!(isNil"R3F_ARTY_active")&&(_l5 select _l7)=="SatPhone")then{_l13=_l12 lbAdd(""+STR_R3F_LOG_nom_pc_arti+format["(%1x)",_l6 select _l7]);}else{_l13=_l12 lbAdd(""+getText(configFile>>"CfgVehicles">>(_l5 select _l7)>>"displayName")+format["(%1x)",_l6 select _l7]);};};_l12 lbSetData[_l13,_l5 select _l7];};};waitUntil(uiNamespace getVariable"R3F_LOG_dlg_contenu_vehicule");R3F_LOG_mutex_local_verrou=false;};