private["_l0","_l1","_l2","_l3","_l4"];private["_l5","_l6","_l7","_l8","_l9","_l10"];private["_l11","_l12","_l13","_l14","_l15","_l16","_l17","_l18","_l19","_l20","_l21","_l22"];if(isNil"_this")then{_this=[];};if(count _this>0)then{_l0=_this select 0;}else{_l0=-1;};if(count _this>1)then{_l1=_this select 1;}else{_l1=-1;};if(count _this>2)then{_l2=_this select 2;}else{_l2=-1;};if(count _this>3)then{_l3=_this select 3;}else{_l3=[-1,-1];};if(count _this>4)then{_l4=_this select 4;}else{_l4=false;};_l5=8;_l6=15;_l7=10;_l8=10;_l11=0;_l12=0.3;_l13=0;_l14=0.2;_l15=0.2;_l16=0.6;_l17=0;_l18=4;_l10=25;_l9=20;_l19=3;_l20=(_l6+_l8)/13;_l21=false;drn_DynamicWeather_DebugTextEventArgs=[];"drn_DynamicWeather_DebugTextEventArgs"addPublicVariableEventHandler{drn_DynamicWeather_DebugTextEventArgs call drn_fnc_DynamicWeather_ShowDebugTextLocal;};drn_fnc_DynamicWeather_ShowDebugTextLocal={private["_l23","_l24"];if(!isNull player)then{player sideChat(_this select 0);};_l23=floor(time/60);_l24=floor(time-(_l23*60));diag_log((str _l23+":"+str _l24)+"Debug:"+(_this select 0));};drn_fnc_DynamicWeather_ShowDebugTextAllClients={drn_DynamicWeather_DebugTextEventArgs=_this;publicVariable"drn_DynamicWeather_DebugTextEventArgs";drn_DynamicWeather_DebugTextEventArgs call drn_fnc_DynamicWeather_ShowDebugTextLocal;};if(_l4)then{["Starting script WeatherEffects.sqf..."]call drn_fnc_DynamicWeather_ShowDebugTextLocal;};drn_DynamicWeatherEventArgs=[];drn_AskServerDynamicWeatherEventArgs=[];drn_fnc_DynamicWeather_SetWeatherLocal={private["_l25","_l26","_l27","_l28","_targetWeatherValue","_l29","_l30","_l31"];_l25=_this select 0;_l26=_this select 1;_l27=_this select 2;_l28=_this select 3;_targetWeatherValue=_this select 4;_l29=_this select 5;_l30=_this select 6;_l31=_this select 7;0 setOvercast _l25;0 setFog _l26;drn_var_DynamicWeather_Rain=_l27;setWind[_l30,_l31,true];if(_l28=="OVERCAST")then{_l29 setOvercast _targetWeatherValue;};if(_l28=="FOG")then{_l29 setFog _targetWeatherValue;};};if(!isServer)then{"drn_DynamicWeatherEventArgs"addPublicVariableEventHandler{drn_DynamicWeatherEventArgs call drn_fnc_DynamicWeather_SetWeatherLocal;};waitUntil{!isNil"drn_var_DynamicWeather_ServerInitialized"};drn_AskServerDynamicWeatherEventArgs=[true];publicVariable"drn_AskServerDynamicWeatherEventArgs";};if(isServer)then{drn_fnc_DynamicWeather_SetWeatherAllClients={private["_l29","_l28"];_l29=drn_DynamicWeather_WeatherChangeCompletedTime-drn_DynamicWeather_WeatherChangeStartedTime;if(_l29>0)then{_l28=drn_DynamicWeather_CurrentWeatherChange;}else{_l28="";};drn_DynamicWeatherEventArgs=[overcast,fog,drn_var_DynamicWeather_Rain,_l28,drn_DynamicWeather_WeatherTargetValue,_l29,drn_DynamicWeather_WindX,drn_DynamicWeather_WindZ];publicVariable"drn_DynamicWeatherEventArgs";drn_DynamicWeatherEventArgs call drn_fnc_DynamicWeather_SetWeatherLocal;};"drn_AskServerDynamicWeatherEventArgs"addPublicVariableEventHandler{call drn_fnc_DynamicWeather_SetWeatherAllClients;};drn_DynamicWeather_CurrentWeatherChange="";drn_DynamicWeather_WeatherTargetValue=0;drn_DynamicWeather_WeatherChangeStartedTime=time;drn_DynamicWeather_WeatherChangeCompletedTime=time;drn_DynamicWeather_WindX=_l3 select 0;drn_DynamicWeather_WindZ=_l3 select 1;if(_l0==-1)then{_l0=(_l11+random(_l12-_l11));}else{if(_l0<_l11)then{_l0=_l11;};if(_l0>_l12)then{_l0=_l12;};};0 setFog _l0;if(_l1==-1)then{_l1=(_l13+random(_l14-_l13));}else{if(_l1<_l13)then{_l1=_l13;};if(_l1>_l14)then{_l1=_l14;};};0 setOvercast _l1;if(_l1>=0.75)then{if(_l2==-1)then{_l2=(_l15+random(_l15-_l15));}else{if(_l2<_l15)then{_l2=_l15;};if(_l2>_l16)then{_l2=_l16;};};}else{_l2=0;};drn_var_DynamicWeather_Rain=_l2;0 setRain drn_var_DynamicWeather_Rain;_l22=_l17+random(_l18-_l17);if(drn_DynamicWeather_WindX==-1)then{if(random 100<50)then{drn_DynamicWeather_WindX=-_l17-random(_l22-_l17);}else{drn_DynamicWeather_WindX=_l17+random(_l22-_l17);};};if(drn_DynamicWeather_WindZ==-1)then{if(random 100<50)then{drn_DynamicWeather_WindZ=-_l17-random(_l22-_l17);}else{drn_DynamicWeather_WindZ=_l17+random(_l22-_l17);};};setWind[drn_DynamicWeather_WindX,drn_DynamicWeather_WindZ,true];sleep 0.05;publicVariable"drn_var_DynamicWeather_Rain";drn_var_DynamicWeather_ServerInitialized=true;publicVariable"drn_var_DynamicWeather_ServerInitialized";[_l5,_l6,_l7,_l8,_l11,_l12,_l13,_l14,_l17,_l18,_l10,_l4]spawn{private["_l5","_l6","_l7","_l8","_l11","_l12","_l13","_l14","_l17","_l18","_l10","_l4"];private["_l32","_l33","_l34","_l35","_l36","_l37"];_l5=_this select 0;_l6=_this select 1;_l7=_this select 2;_l8=_this select 3;_l11=_this select 4;_l12=_this select 5;_l13=_this select 6;_l14=_this select 7;_l17=_this select 8;_l18=_this select 9;_l10=_this select 10;_l4=_this select 11;_l33=2;_l34=2;while{true}do{sleep floor(_l7*60+random((_l8-_l7)*60));if(_l11==_l12 && _l13!=_l14)then{_l32="OVERCAST";};if(_l11!=_l12 && _l13==_l14)then{_l32="FOG";};if(_l11!=_l12 && _l13!=_l14)then{if((random 100)<50)then{_l32="OVERCAST";}else{_l32="FOG";};};if(_l32=="FOG")then{drn_DynamicWeather_CurrentWeatherChange="FOG";_l35=_l33;_l33=floor((random 100)/25);while{_l33==_l35}do{_l33=floor((random 100)/25);};if(_l33==0)then{drn_DynamicWeather_WeatherTargetValue=_l11+(_l12-_l11)*random 0.05;};if(_l33==1)then{drn_DynamicWeather_WeatherTargetValue=_l11+(_l12-_l11)*(0.05+random 0.2);};if(_l33==2)then{drn_DynamicWeather_WeatherTargetValue=_l11+(_l12-_l11)*(0.25+random 0.3);};if(_l33==3)then{drn_DynamicWeather_WeatherTargetValue=_l11+(_l12-_l11)*(0.55+random 0.45);};drn_DynamicWeather_WeatherChangeStartedTime=time;_l37=_l5*60+random((_l6-_l5)*60);drn_DynamicWeather_WeatherChangeCompletedTime=time+_l37;if(_l4)then{["Weather forecast: Fog"+str drn_DynamicWeather_WeatherTargetValue+"in"+str round(_l37/60)+"minutes."]call drn_fnc_DynamicWeather_ShowDebugTextAllClients;};};if(_l32=="OVERCAST")then{drn_DynamicWeather_CurrentWeatherChange="OVERCAST";_l36=_l34;_l34=3;while{_l34==_l36}do{_l34=floor((random 100)/25);};if(_l34==0)then{drn_DynamicWeather_WeatherTargetValue=_l13+(_l14-_l13)*random 0.05;};if(_l34==1)then{drn_DynamicWeather_WeatherTargetValue=_l13+(_l14-_l13)*(0.05+random 0.3);};if(_l34==2)then{drn_DynamicWeather_WeatherTargetValue=_l13+(_l14-_l13)*(0.35+random 0.35);};if(_l34==3)then{drn_DynamicWeather_WeatherTargetValue=_l13+(_l14-_l13)*(0.7+random 0.3);};drn_DynamicWeather_WeatherChangeStartedTime=time;_l37=_l5*60+random((_l6-_l5)*60);drn_DynamicWeather_WeatherChangeCompletedTime=time+_l37;if(_l4)then{["Weather forecast: Overcast"+str drn_DynamicWeather_WeatherTargetValue+"in"+str round(_l37/60)+"minutes."]call drn_fnc_DynamicWeather_ShowDebugTextAllClients;};};if(random 100<_l10)then{private["_l22"];_l22=_l17+random(_l18-_l17);if(random 100<50)then{drn_DynamicWeather_WindX=-_l17-random(_l22-_l17);}else{drn_DynamicWeather_WindX=_l17+random(_l22-_l17);};if(random 100<50)then{drn_DynamicWeather_WindZ=-_l17-random(_l22-_l17);}else{drn_DynamicWeather_WindZ=_l17+random(_l22-_l17);};if(_l4)then{["Wind changes:["+str drn_DynamicWeather_WindX+","+str drn_DynamicWeather_WindZ+"]."]call drn_fnc_DynamicWeather_ShowDebugTextAllClients;};};call drn_fnc_DynamicWeather_SetWeatherAllClients;sleep _l37;};};if(_l9>0)then{[_l15,_l16,_l21,_l19,_l20,_l9,_l4]spawn{private["_l15","_l16","_l21","_l19","_l20","_l9","_l4"];private["_l38","_l39"];_l15=_this select 0;_l16=_this select 1;_l21=_this select 2;_l19=_this select 3;_l20=_this select 4;_l9=_this select 5;_l4=_this select 6;if(rain>0)then{drn_var_DynamicWeather_Rain=rain;publicVariable"drn_var_DynamicWeather_Rain";};_l38=time;_l39=false;while{true}do{if(overcast>0.75)then{if(time>=_l38)then{private["_l40"];if(random 100<_l9 &&!_l39)then{drn_var_DynamicWeather_rain=_l15+random(_l16-_l15);publicVariable"drn_var_DynamicWeather_rain";_l39=_l21;}else{drn_var_DynamicWeather_rain=0;publicVariable"drn_var_DynamicWeather_rain";_l39=false;};_l40=_l19*60+random((_l20-_l19)*60);_l38=time+_l40;if(_l4)then{["Rain set to"+str drn_var_DynamicWeather_rain+"for"+str(_l40/60)+"minutes"]call drn_fnc_DynamicWeather_ShowDebugTextAllClients;};};}else{if(drn_var_DynamicWeather_rain!=0)then{drn_var_DynamicWeather_rain=0;publicVariable"drn_var_DynamicWeather_rain";if(_l4)then{["Rain stops due to low overcast."]call drn_fnc_DynamicWeather_ShowDebugTextAllClients;};};_l38=time;_l39=false;};if(_l4)then{sleep 1;}else{sleep 10;};};};};};[_l9,_l4]spawn{private["_l9","_l4"];private["_l41","_l42"];_l9=_this select 0;_l4=_this select 1;if(_l4)then{_l42=0.2;}else{_l42=0.03;};if(_l9>0)then{_l41=drn_var_DynamicWeather_Rain;}else{_l41=0;};0 setRain _l41;sleep 0.1;while{true}do{if(_l9>0)then{if(_l41<drn_var_DynamicWeather_Rain)then{_l41=_l41+_l42;if(_l41>1)then{_l41=1;};};if(_l41>drn_var_DynamicWeather_Rain)then{_l41=_l41-_l42;if(_l41<0)then{_l41=0;};};}else{_l41=0;};3 setRain _l41;sleep 3;};};